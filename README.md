cafy
===============================================
> Simple, fun, flexible query-based validator

**cafy**ã¯ã€ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚ˆã†ã«ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§å€¤ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
cafyã‚’ä½¿ãˆã°ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¥½ã—ããƒ»ç°¡å˜ã«ãƒ»æŸ”è»Ÿã«æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚TypeScriptã‚’å®Œå…¨ã«ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ğŸ’ª
[Try it out!](https://runkit.com/npm/cafy)

[![][npm-badge]][npm-link]
[![][mit-badge]][mit]
[![][travis-badge]][travis-link]
[![][himawari-badge]][himasaku]
[![][sakurako-badge]][himasaku]

[![NPM](https://nodei.co/npm/cafy.png?downloads=true&downloadRank=true&stars=true)](https://www.npmjs.com/package/cafy)

ğŸ¤” Why cafy
-----------------------------------------------
ãŸã¨ãˆã°Web APIã‚’æ›¸ãã¨ãã«ã€ã¡ã‚ƒã‚“ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚Œã¦ããŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ­£ã—ã„å½¢å¼ã‹ç¢ºèªã—ãªã„ã¨ã€ã‚¯ã‚¨ãƒªã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³(NoSQLã§ã‚ã£ã¦ã‚‚ç™ºç”Ÿã—å¾—ã¾ã™)ã‚„SSJIã€[ReDoS](https://en.wikipedia.org/wiki/ReDoS)ãªã©ã®æ€ã‚ã¬ä¸å…·åˆã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™(ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’JSONãªã©ã§å—ã‘ä»˜ã‘ã¦ã„ã‚‹ã‚ˆã†ãªå ´åˆã¯ç‰¹ã«)ã€‚ãã‚Œã‚’é˜²ããŸã‚ã«å€¤ã®æ­£å½“æ€§ã®æ¤œè¨¼ã¯é‡è¦ã§ã™ã€‚
cafyã‚’ä½¿ãˆã°ã€*ã€Œã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯nullã‚„undefinedã§ã¯ãªã„æ–‡å­—åˆ—ã§ãªãã¦ã¯ãªã‚‰ãšã€1æ–‡å­—ä»¥ä¸Š100æ–‡å­—ä»¥ä¸‹ã§ãªãã¦ã¯ãªã‚‰ãšã€a-z0-9ã®æ–‡å­—ç¨®ã§æ§‹æˆã•ã‚Œã¦ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€*ã¨ã„ã£ãŸé•·ã„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã€**ãŸã£ãŸä¸€è¡Œã§ç°¡æ½”ã«**æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚
ä¾‹å¤–ã‚‚è¡Œã†ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã”ã¨ã«ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ğŸ“¦ Installation
-----------------------------------------------
Just `npm install cafy --save`.
Happy validationğŸ‘

â˜˜ Usage
-----------------------------------------------
``` javascript
cafy(value)[.anyQueries()...]
```

---

ã¾ãšãã®å€¤ãŒã©ã‚“ãªå‹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‹ã‚’ç¤ºã—ã€
ãã®ã‚ã¨ã«è¿½åŠ ã®åˆ¶ç´„ã‚’ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§è¿½åŠ ã—ã¦ã„ãã‚¹ã‚¿ã‚¤ãƒ«ã§ã™ã€‚

(ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€`import $ from 'cafy';`ã—ã¦ã„ã‚‹å‰æã§æ›¸ã„ã¦ã„ãã¾ã™(å®Ÿéš›ã«ã¯cafyé–¢æ•°ã«ã©ã‚“ãªåå‰ã‚’ä»˜ã‘ã‚‹ã‹ã¯è‡ªç”±ã§ã™)ã€‚)

ãŸã¨ãˆã°*ã€Œ`x`ã¯æ–‡å­—åˆ—ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€*ã¯ã“ã†æ›¸ãã¾ã™:
``` javascript
$(x).string()
```
`range`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ©ç”¨ã—ã¦ã€*ã€Œ10æ–‡å­—ä»¥ä¸Š20æ–‡å­—ä»¥ä¸‹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€*ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†:
``` javascript
$(x).string().range(10, 20)
```
æ¤œè¨¼ã—ã¦çµæœã‚’å–å¾—ã™ã‚‹ã«ã¯`test`ã‚„`ok`ãƒ¡ã‚½ãƒƒãƒ‰ãªã©ã‚’åˆ©ç”¨ã§ãã¾ã™:
``` javascript
$('strawberry pasta').string().range(10, 20).ok()
// => true

$('alice').string().range(10, 20).ok()
// => çŸ­ã™ãã‚‹ã®ã§ false

$('i love strawberry pasta').string().range(10, 20).ok()
// => é•·ã™ãã‚‹ã®ã§ false
```

`ok`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆæ ¼ã—ãŸå ´åˆã¯`true`ã‚’ã€å¤±æ ¼ã—ãŸå ´åˆã¯`false`ã‚’è¿”ã—ã¾ã™ã€‚
`test`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆæ ¼ã—ãŸå ´åˆã¯`null`ã‚’ã€å¤±æ ¼ã—ãŸå ´åˆã¯`Error`ã‚’è¿”ã—ã¾ã™ã€‚

---

ã‚‚ã¡ã‚ã‚“æ–‡å­—åˆ—ä»¥å¤–ã«ã‚‚ã€æ¬¡ã®å‹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™:

Supported types
* **any** ... e.g.`$(x).any()...`
* **array** ... e.g.`$(x).array()...`
* **boolean** ... e.g.`$(x).boolean()...`
* **number** ... e.g.`$(x).number()...`
* **object** ... e.g.`$(x).object()...`
* **string** ... e.g.`$(x).string()...`
* **ObjectID** (MongoDB) ... e.g.`$(x).id()...`

> â„¹ JavaScriptã®ä»•æ§˜ä¸Šã§ã¯é…åˆ—ã¯objectã§ã™ãŒã€cafyã§ã¯é…åˆ—ã¯objectã¨ã¯è¦‹ãªã•ã‚Œã¾ã›ã‚“ã€‚

ã©ã‚“ãªå‹ã®ãƒãƒªãƒ‡ãƒ¼ã‚¿ã«ã©ã‚“ãªãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã‹ã¯[APIã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³](#api)ã‚’è¦‹ã¦ã¿ã¦ãã ã•ã„ï¼

### é…åˆ—ã®è¦ç´ ã®å‹ã‚’æŒ‡å®šã™ã‚‹
é…åˆ—ã®è¦ç´ ãŒã©ã‚“ãªå‹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã‹æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™:
``` javascript
$(x).array('string')
```
ã¡ãªã¿ã«ã“ã‚Œã¯æ¬¡ã®ç³–è¡£æ§‹æ–‡ã§ã™:
``` javascript
$(x).array().each($().string())
```

### null ã¨ undefined ã®æ‰±ã„
#### undefined ã‚’è¨±å¯ã™ã‚‹ *(optional)*
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§`undefined`ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™:
``` javascript
$(undefined).string().ok() // <= false
```
`undefined`ã‚’è¨±å¯ã™ã‚‹å ´åˆã¯`optional`ã‚’å‹ã®å‰ã«ä»˜ã‘ã¾ã™:
``` javascript
$(undefined).optional.string().ok() // <= true
```

#### null ã‚’è¨±å¯ã™ã‚‹ *(nullable)*
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§`null`ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™:
``` javascript
$(null).string().ok() // <= false
```
`null`ã‚’è¨±å¯ã™ã‚‹å ´åˆã¯`nullable`ã‚’å‹ã®å‰ã«ä»˜ã‘ã¾ã™:
``` javascript
$(null).nullable.string().ok() // <= true
```

#### null ã¨ undefined ã‚’è¨±å¯ã™ã‚‹
`nullable`ã¨`optional`ã¯ä½µç”¨ã§ãã¾ã™:
``` javascript
$(x).nullable.optional.string()
```

|                         | undefined | null |
| -----------------------:|:---------:|:----:|
| (default)               | x         | x    |
| `optional`              | o         | x    |
| `nullable`              | x         | o    |
| `optional` + `nullable` | o         | o    |

### é…å»¶æ¤œè¨¼
cafyã®å¼•æ•°ã‚’çœç•¥ã™ã‚‹ã“ã¨ã§ã€å¾Œã‹ã‚‰å€¤ã‚’æ¤œè¨¼ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚¿ã«ãªã‚Šã¾ã™:
``` javascript
$().number().range(30, 50)
```
`test`ã‚„`ok`ãƒ¡ã‚½ãƒƒãƒ‰ã«å€¤ã‚’ä¸ãˆã¦æ¤œè¨¼ã—ã¾ã™:
``` javascript
$().number().range(30, 50).test(42) // <= null
```

ã“ã®é…å»¶æ¤œè¨¼ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€é…åˆ—ã®`some`ãªã©ã«æ¸¡ã™ã¨ãã«ä¾¿åˆ©ã§ã™:
``` javascript
xs.some($().number().max(30).nok)
```

â„¹ï¸ `nok`ã¯`ok`ã®é€†ã§ã™ã€‚

ãƒãƒªãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã„å›ã—ãŸã„ã¨ãã‚‚ç°¡å˜ã§ã™:
``` javascript
const isValidGender = $().string().or('male|female').ok;

isValidGender('male')   // true
isValidGender('female') // true
isValidGender('alice')  // false
```

### ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å³æ ¼ãªæ¤œè¨¼ *(strict)*
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`have`ã‚„`prop`ã§è¨€åŠã—ãŸä»¥å¤–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã£ã¦ã„ã¦ã‚‚ã€å•é¡Œã«ã¯ã—ã¾ã›ã‚“:
``` javascript
$({ x: 42, y: 24 }).object().have('x', $().number()).ok() // <= true
```
`have`ã¾ãŸã¯`prop`ã§è¨€åŠã—ãŸä»¥å¤–ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã«ã‚¨ãƒ©ãƒ¼ã«ã—ãŸã„å ´åˆã¯ã€`strict`ã‚’`object`ã®å‰ã«ä»˜ã‘ã¾ã™:
``` javascript
$({ x: 42, y: 24 }).strict.object().have('x', $().number()).ok() // <= false
```

### Any
Anyå‹ã‚’ä½¿ã†ã¨ã€ã€Œ*undefined*ã‚„*null*ã¯ãƒ€ãƒ¡ã ã‘ã©ã€å‹ã¯ä½•ã§ã‚‚ã„ã„ã€ã¨ã„ã£ãŸå€¤ã‚’æ¤œè¨¼ã—ãŸã„ã¨ãã«ä¾¿åˆ©ã§ã™:
``` javascript
$('strawberry pasta').any().ok() // <= true
```
ã€Œå¿…ãš`x`ã¨ã„ã†ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã£ã¦ã„ã¦ã»ã—ã„ã€‚ä¸­èº«ã¯nullã‚„undefinedä»¥å¤–ãªã‚‰ä½•ã§ã‚‚ã„ã„ã€ã®ã‚ˆã†ãªå ´åˆã‚‚anyã‚’æ´»ç”¨ã§ãã¾ã™:
``` javascript
$({ x: 'strawberry pasta' }).object().have('x', $().any()).ok() // <= true
```

### Flexible array
`flexible`ã‚’`array`ã®å‰ã«ä»˜ã‘ã‚‹ã¨ã€é…åˆ—ã§ãªã„å€¤ã‚’è¦ç´ æ•°1ã®é…åˆ—ã«å¤‰æ›ã—ã¾ã™:
``` javascript
$(42).flexible.array().length(1).ok() // <= true
```

ğŸ’¡ Tips
-----------------------------------------------
### è¦å®šå€¤ã‚’è¨­å®šã™ã‚‹
[Destructuring assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)ã®è¦å®šå€¤æ§‹æ–‡ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
``` javascript
const [val = 'desc', err] = $(x).optional.string().or('asc|desc').$;
//â†’ xã¯æ–‡å­—åˆ—ã§ãªã‘ã‚Œã°ãªã‚‰ãšã€'asc'ã¾ãŸã¯'desc'ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚çœç•¥ã•ã‚ŒãŸå ´åˆã¯'desc'ã¨ã™ã‚‹ã€‚
```

### cafyã®å…¥ã‚Œå­
cafyåŒå£«ã¯ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«é€£æºã™ã‚‹ã®ã§ã€å…¥ã‚Œå­ã«ã—ã¦ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™:
``` javascript
$(x).array().each($().string().range(0, 100))
//â†’ xã¯å…¨ã¦ã®è¦ç´ ãŒ0æ–‡å­—ä»¥ä¸Š100æ–‡å­—ä»¥å†…ã®æ–‡å­—åˆ—ã®é…åˆ—ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
```

ğŸ“– API
-----------------------------------------------
â„¹ï¸ è¿”ã‚Šå€¤ãŒ`Query`ã¨è¡¨è¨˜ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¯ã€ãã®ã‚ã¨ã«ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã‚’
ç¹‹ã’ã¦ã„ãã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

### å…±é€š

#### `.pipe(fn)` => `Query`
ã‚«ã‚¹ã‚¿ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚
å¼•æ•°ã®é–¢æ•°ãŒ`true`ã‚’è¿”ã™ã¨å¦¥å½“ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€`false`ã¾ãŸã¯`Error`ã‚’è¿”ã™ã¨ä¸æ­£ãªå€¤ã¨ã—ã¾ã™ã€‚
``` javascript
$('strawberry pasta').string().pipe(x => x.indexOf('alice') == -1).ok() // true
$(['a', 'b', 'c']).array().pipe(x => x[1] != 'b').ok() // false
```

#### `.$` => `[any, Error]`
ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å€¤ã¨ãƒ†ã‚¹ãƒˆçµæœã®ãƒšã‚¢(é…åˆ—)ã€‚å…ˆè¡Œæ¤œè¨¼ã®ã¨ãã®ã¿åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

#### `.test(value?)` => `Error`
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
åˆæ ¼ã—ãŸå ´åˆã¯`null`ã§ã€ãã†ã§ãªã„å ´åˆã¯`Error`ã§ã™ã€‚
é…å»¶æ¤œè¨¼ã‚’è¡Œã†ã¨ãã¯ã€ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å€¤ã‚’å¼•æ•°ã¨ã—ã¦ä¸ãˆã¾ã™ã€‚
å…ˆè¡Œæ¤œè¨¼ã®ã¨ãã¯ã€å¼•æ•°ã¯å˜ã«ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

#### `.ok(value?)` => `boolean`
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
åˆæ ¼ã—ãŸå ´åˆã¯`true`ã§ã€ãã†ã§ãªã„å ´åˆã¯`false`ã§ã™ã€‚
`.test() == null`ã¨åŒç¾©ã§ã™ã€‚
é…å»¶æ¤œè¨¼ã‚’è¡Œã†ã¨ãã¯ã€ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å€¤ã‚’å¼•æ•°ã¨ã—ã¦ä¸ãˆã¾ã™ã€‚
å…ˆè¡Œæ¤œè¨¼ã®ã¨ãã¯ã€å¼•æ•°ã¯å˜ã«ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

#### `.nok(value?)` => `boolean`
ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
åˆæ ¼ã—ãŸå ´åˆã¯`false`ã§ã€ãã†ã§ãªã„å ´åˆã¯`true`ã§ã™ã€‚
`.ok()`ã®å¦å®šã§ã™ã€‚
(*nok* ã¯ _**n**ot **ok**_ ã®ç•¥ã§ã™)
é…å»¶æ¤œè¨¼ã‚’è¡Œã†ã¨ãã¯ã€ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®å€¤ã‚’å¼•æ•°ã¨ã—ã¦ä¸ãˆã¾ã™ã€‚
å…ˆè¡Œæ¤œè¨¼ã®ã¨ãã¯ã€å¼•æ•°ã¯å˜ã«ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

### Any
Anyç‹¬è‡ªã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### Array
#### `.min(threshold)` => `Query`
è¦ç´ ã®æ•°ãŒ`threshold`ä»¥ä¸Šã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
è¦ç´ æ•°ãŒ`threshold`ã‚’ä¸‹å›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.max(threshold)` => `Query`
è¦ç´ ã®æ•°ãŒ`threshold`ä»¥ä¸‹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
è¦ç´ æ•°ãŒ`threshold`ã‚’ä¸Šå›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.range(min, max)` => `Query`
`min`ä»¥ä¸Š`max`ä»¥ä¸‹ã®æ•°ã®è¦ç´ ã‚’æŒã£ã¦ã„ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
è¦ç´ æ•°ãŒæŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã«ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
``` javascript
$(['a', 'b', 'c']).range(2, 5).ok()                // true
$(['a', 'b', 'c', 'd', 'e', 'f']).range(2, 5).ok() // false
$(['a']).range(2, 5).ok()                          // false
```

â„¹ï¸ `range(30, 50)`ã¯`min(30).max(50)`ã¨åŒç¾©ã§ã™ã€‚

#### `.length(length)` => `Query`
è¦ç´ ã®æ•°ãŒ`length`ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
è¦ç´ æ•°ãŒ`length`ã§ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.unique()` => `Query`
ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªé…åˆ—(=é‡è¤‡ã—ãŸå€¤ã‚’æŒã£ã¦ã„ãªã„)ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
é‡è¤‡ã—ãŸè¦ç´ ãŒã‚ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
``` javascript
$(['a', 'b', 'c']).array().unique().ok()      // true
$(['a', 'b', 'c', 'b']).array().unique().ok() // false
```

#### `.item(index, fn)` => `Query`
ç‰¹å®šã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¦ç´ ã«å¯¾ã—ã¦ã‚«ã‚¹ã‚¿ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚
å¼•æ•°ã®é–¢æ•°ãŒ`true`ã‚’è¿”ã™ã¨å¦¥å½“ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€`false`ã¾ãŸã¯`Error`ã‚’è¿”ã™ã¨ä¸æ­£ãªå€¤ã¨ã—ã¾ã™ã€‚
å¼•æ•°ã«ã¯cafyã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚æ¸¡ã›ã¾ã™ã€‚
``` javascript
$(['a', 42,  'c']).array().item(1, $().number()).ok() // true
$(['a', 'b', 'c']).array().item(1, $().number()).ok() // false
```

#### `.each(fn)` => `Query`
å„è¦ç´ ã«å¯¾ã—ã¦ã‚«ã‚¹ã‚¿ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚
å¼•æ•°ã®é–¢æ•°ãŒ`true`ã‚’è¿”ã™ã¨å¦¥å½“ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€`false`ã¾ãŸã¯`Error`ã‚’è¿”ã™ã¨ä¸æ­£ãªå€¤ã¨ã—ã¾ã™ã€‚
å¼•æ•°ã«ã¯cafyã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚æ¸¡ã›ã¾ã™ã€‚
``` javascript
$([1, 2, 3]).array().each(x => x < 4).ok() // true
$([1, 4, 3]).array().each(x => x < 4).ok() // false
```

#### `.eachQ(fn)` => `Query`
å„è¦ç´ ã«å¯¾ã—ã¦ã®ã‚¯ã‚¨ãƒªã‚’è¿½åŠ ã—ã¾ã™ã€‚
``` javascript
$(['hoge', 'piyo']).array('string').eachQ(q => q.or(['hoge', 'piyo'])).ok() // true
$(['hoge', 'fuga']).array('string').eachQ(q => q.or(['hoge', 'piyo'])).ok() // false
```

### Boolean
Booleanç‹¬è‡ªã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### ID
IDç‹¬è‡ªã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### Number
#### `.int()` => `Query`
æ•´æ•°ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ•´æ•°ã§ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
``` javascript
$(0       ).number().int().ok() // true
$(1       ).number().int().ok() // true
$(-100    ).number().int().ok() // true

$(0.1     ).number().int().ok() // false
$(Math.PI ).number().int().ok() // false

$(NaN     ).number().int().ok() // false
$(Infinity).number().int().ok() // false
```

#### `.min(threshold)` => `Query`
`threshold`ä»¥ä¸Šã®æ•°å€¤ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
å€¤ãŒ`threshold`ã‚’ä¸‹å›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.max(threshold)` => `Query`
`threshold`ä»¥ä¸‹ã®æ•°å€¤ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
å€¤ãŒ`threshold`ã‚’ä¸Šå›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.range(min, max)` => `Query`
`min`ä»¥ä¸Š`max`ä»¥ä¸‹ã®æ•°å€¤ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
å€¤ãŒæŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã«ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

â„¹ï¸ `range(30, 50)`ã¯`min(30).max(50)`ã¨åŒç¾©ã§ã™ã€‚

### Object
#### `.prop(name, fn)` => `Query`
ç‰¹å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚«ã‚¹ã‚¿ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚
å¼•æ•°ã®é–¢æ•°ãŒ`true`ã‚’è¿”ã™ã¨å¦¥å½“ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€`false`ã¾ãŸã¯`Error`ã‚’è¿”ã™ã¨ä¸æ­£ãªå€¤ã¨ã—ã¾ã™ã€‚
ãã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ãªã‹ã£ãŸå ´åˆã¯å˜ã«ç„¡è¦–ã•ã‚Œã¾ã™ã€‚
å¼•æ•°ã«ã¯cafyã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚æ¸¡ã›ã¾ã™ã€‚
``` javascript
$({ myProp: true }).object().prop('myProp', $().boolean()).ok() // true
```

è¤‡é›‘ãªä¾‹:
``` javascript
const x = {
  some: {
    strawberry: 'pasta',
    alice: false,
    tachibana: {
      bwh: [68, 52, 67]
    }
  },
  thing: 42
};

$(x).object()
  .prop('some', $().object()
    .prop('strawberry', $().string())
    .prop('alice', $().boolean())
    .prop('tachibana'), $().object()
      .prop('bwh', $().array('number')))
  .prop('thing', $().number())
  .ok() // true
```

#### `.have(name, fn)` => `Query`
ç‰¹å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚«ã‚¹ã‚¿ãƒ ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚
å¼•æ•°ã®é–¢æ•°ãŒ`true`ã‚’è¿”ã™ã¨å¦¥å½“ã¨ã„ã†ã“ã¨ã«ãªã‚Šã€`false`ã¾ãŸã¯`Error`ã‚’è¿”ã™ã¨ä¸æ­£ãªå€¤ã¨ã—ã¾ã™ã€‚
ãã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨ã—ãªã‹ã£ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
å¼•æ•°ã«ã¯cafyã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚‚æ¸¡ã›ã¾ã™ã€‚

`fn`ã‚’çœç•¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ãã®å ´åˆã€æ¬¡ã¨ç­‰ä¾¡ã§ã™:
``` javascript
have('x', () => true)
```

### String
#### `.match(pattern)` => `Query`
ä¸ãˆã‚‰ã‚ŒãŸæ­£è¦è¡¨ç¾ã¨ãƒãƒƒãƒã—ã¦ã„ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ­£è¦è¡¨ç¾ã¨ä¸€è‡´ã—ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
``` javascript
$('2017-03-07').string().match(/^([0-9]{4})\-([0-9]{2})-([0-9]{2})$/).ok() // true
```

#### `.or(pattern)` => `Query`
ä¸ãˆã‚‰ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³å†…ã®æ–‡å­—åˆ—ã®ã„ãšã‚Œã‹ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
`pattern`ã¯æ–‡å­—åˆ—ã®é…åˆ—ã¾ãŸã¯`|`ã§åŒºåˆ‡ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã§ã™ã€‚
ã©ã‚Œã¨ã‚‚ä¸€è‡´ã—ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚
``` javascript
$('strawberry').string().or(['strawberry', 'pasta']).ok() // true
$('alice').string().or(['strawberry', 'pasta']).ok()      // false
$('pasta').string().or('strawberry|pasta').ok()           // true
```

#### `.min(threshold)` => `Query`
`threshold`ä»¥ä¸Šã®æ–‡å­—æ•°ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ–‡å­—æ•°ãŒ`threshold`ã‚’ä¸‹å›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.max(threshold)` => `Query`
`threshold`ä»¥ä¸‹ã®æ–‡å­—æ•°ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ–‡å­—æ•°ãŒ`threshold`ã‚’ä¸Šå›ã‚‹å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

#### `.range(min, max)` => `Query`
`min`ä»¥ä¸Š`max`ä»¥ä¸‹ã®æ–‡å­—æ•°ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ–‡å­—æ•°ãŒæŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã«ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

â„¹ï¸ `range(30, 50)`ã¯`min(30).max(50)`ã¨åŒç¾©ã§ã™ã€‚

#### `.length(length)` => `Query`
æ–‡å­—æ•°ãŒ`length`ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã¨ã„ã†åˆ¶ç´„ã‚’è¿½åŠ ã—ã¾ã™ã€‚
æ–‡å­—æ•°ãŒ`length`ã§ãªã„å ´åˆã‚¨ãƒ©ãƒ¼ã«ã—ã¾ã™ã€‚

ğŸ“Œ Examples
-----------------------------------------------

### With your api server
``` javascript
import * as express from 'express';
import $ from 'cafy';
import db from './mydb';

const app = express();

app.post('/create-account', (req, res) => {
  // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåã¯æ–‡å­—åˆ—ã§ã€30æ–‡å­—ä»¥å†…ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã“ã®å€¤ã¯å¿…é ˆã§ã‚ã‚‹ã€‚
  const [name, nameErr] = $(req.body.name).string().max(30).$;
  if (nameErr) return res.status(400).send('invalid name');

  // å¹´é½¢ã¯æ•°å€¤ã§ã€0~100ã®æ•´æ•°ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ã“ã®å€¤ã¯å¿…é ˆã§ã‚ã‚‹ã€‚
  const [age, ageErr] = $(req.body.age).number().int().range(0,100).$;
  if (ageErr) return res.status(400).send('invalid age');

  // æ€§åˆ¥ã¯'male'ã‹'female'ã‹null(=è¨­å®šãªã—)ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚çœç•¥ã—ãŸå ´åˆã¯nullã¨ã—ã¦æ‰±ã†ã€‚
  const [gender = null, genderErr] = $(req.body.gender).nullable.optional.string().or('male|female').$;
  if (genderErr) return res.status(400).send('invalid gender');

  db.insert({
    name, age, gender
  });

  res.send('yee haw!');
});
```

âš—ï¸ Testing
-----------------------------------------------
`npm run test`

License
-----------------------------------------------
[MIT](LICENSE)

[npm-link]:       https://www.npmjs.com/package/cafy
[npm-badge]:      https://img.shields.io/npm/v/cafy.svg?style=flat-square
[mit]:            http://opensource.org/licenses/MIT
[mit-badge]:      https://img.shields.io/badge/license-MIT-444444.svg?style=flat-square
[travis-link]:    https://travis-ci.org/syuilo/cafy
[travis-badge]:   http://img.shields.io/travis/syuilo/cafy.svg?style=flat-square
[himasaku]:       https://himasaku.net
[himawari-badge]: https://img.shields.io/badge/%E5%8F%A4%E8%B0%B7-%E5%90%91%E6%97%A5%E8%91%B5-1684c5.svg?style=flat-square
[sakurako-badge]: https://img.shields.io/badge/%E5%A4%A7%E5%AE%A4-%E6%AB%BB%E5%AD%90-efb02a.svg?style=flat-square
